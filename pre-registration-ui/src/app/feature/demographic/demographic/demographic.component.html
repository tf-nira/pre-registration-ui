
<div class="spinner" *ngIf="!primaryuserForm && !hasError">
  <mat-spinner></mat-spinner>
</div>

<div>
  <div class="wrapper">
  
    <div class="user" *ngIf="primaryuserForm">
      <header>{{demographiclabels.title}}
        <span>
          (
          <span *ngFor="let dataCaptureLang of dataCaptureLanguagesLabels;index as labelsIndex">
            <span [dir]="userPrefLanguageDir">&nbsp;{{dataCaptureLang}}&nbsp;</span>
          </span>
          )
        </span>
        <span *ngIf="!dataModification && !readOnlyMode && showChangeDataCaptureLangBtn"
          [ngStyle]="userPrefLanguageDir == 'ltr'? {'float': 'right'} : {'float': 'left'}">
          <button class="user__btn user__btn_change_lang" type="button"
            (click)="changeDataCaptureLanguages()">{{demographiclabels.change_data_capture_langs}}</button>
        </span>
      </header>
      <p></p>
      <span class="readOnly" *ngIf="readOnlyMode">( {{demographiclabels.read_only_message}} )</span>
      <hr class="hrBlack" />
      <hr class="hrYellow"> 
      <hr class="hrRed"/>
      <div class="user_container_single_form" *ngIf="primaryuserForm">
        <form [formGroup]="userForm" class="user__form">


          <mat-expansion-panel [expanded]="expStep === 0" (opened)="setStep(0)" hideToggle>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <b>Application Type:</b>
              </mat-panel-title>

            </mat-expansion-panel-header>
            <span *ngFor="let alignmentGroup of alignmentGroups">
              <div class="rowContainer">
                <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                  <div class="fieldContainer"
                    *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_use')">
                    <div class="fieldHeader" [ngStyle]="field.headerStyle">
                      <!-- Create container header with label in user's login lang -->
                      <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                      <span *ngIf="field.required" class="required-annotation">*</span>
                    </div>
                    <div class="fieldContent" [ngStyle]="field.containerStyle">
                      <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                      <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                        <!-- Add TextBox for each dataCaptureLanguage -->
                        <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                          <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy"
                              [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                              <mat-label>
                                {{field.description}}
                              </mat-label>
                              <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                (change)="onChangeHandler(field.id)"
                                (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                #input />
                              <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                            </mat-form-field>
                          </div>
                          <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy"
                              [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                              <!-- Again Label is required at each TextBox level too -->
                              <mat-label>
                                {{field.description}}
                              </mat-label>
                              <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                (change)="onChangeHandler(field.id)"
                                (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                #input />
                            </mat-form-field>
                          </div>
                        </ng-container>
                        <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                        <ng-container *ngIf="field.controlType === 'checkbox'">
                          <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                            <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                              (change)="onChangeHandler(field.id);">
                            </mat-checkbox>&nbsp;&nbsp;
                            <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                              <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                            </span>
                          </span>
                        </ng-container>
                        <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                        <ng-container *ngIf="field.controlType === 'button'">
                          <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                            <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                              (click)="onChangeHandler(field.id);">
                              <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                <span *ngIf="button.languageCode === dataCaptureLanguage">
                                  <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                    title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                    {{button.valueName}}
                                  </mat-button-toggle>
                                </span>
                              </ng-container>
                            </mat-button-toggle-group>
                            <br>
                            <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                              [dir]="dataCaptureLangsDir[i]">
                              <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                <span
                                  *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                  <span class="selectedOption">{{option.valueName}}</span>
                                </span>
                              </span>
                            </span>
                          </span>
                        </ng-container>
                        <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                        <ng-container *ngIf="field.controlType === 'dropdown'">
                          <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy"
                              [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                              <mat-label>
                                {{field.description}}
                              </mat-label>
                              <mat-select formControlName="{{field.id}}"
                                (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                (blur)="onChangeHandler(field.id);" #singleSelect>
                                <mat-option>
                                  <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                    placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                    noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                  </ngx-mat-select-search>
                                </mat-option>
                                <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                  <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                </mat-option>
                                <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                  <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                    <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                      [value]="dropdown.valueCode"
                                      title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                      {{ dropdown.valueName }}
                                    </mat-option>
                                  </ng-container>
                                </ng-container>
                              </mat-select>
                            </mat-form-field>
                            <p></p>
                            <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                              <div class="selectedOption">
                                <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                  <span *ngIf="option.languageCode !== dataCaptureLanguage
                                  && userForm.get(field.id).value != null 
                                  && option.valueCode == userForm.get(field.id).value 
                                  && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                  </span>
                                </span>
                              </div>
                            </span>
                          </span>
                        </ng-container>
                        <!-- Add Age Date fields-->
                        <ng-container *ngIf="field.controlType === 'ageDate'">
                          <span *ngIf="i == 0">
                            <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                              <div class="user__date">
                                <mat-form-field appearance="legacy">
                                  <mat-label>{{localeDtFormat}}</mat-label>
                                  <input matInput [formControlName]="field.id + '_dateCtrl'"
                                    placeholder="{{localeDtFormat}}"
                                    (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                    [matDatepicker]="dp" />
                                  <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                  <mat-datepicker #dp></mat-datepicker>
                                </mat-form-field>
                              </div>
                              <div class="user__pref">
                                {{ "demographic.text_or" | translate }}
                              </div>
                              <div class="user__age">
                                <mat-form-field appearance="legacy">
                                  <input type="number" class="form-control" matInput [value]="currentAge" #age
                                    [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                    (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                </mat-form-field>
                                <div class="user__age--years">
                                  {{ "demographic.text_years" | translate }}
                                </div>
                              </div>
                            </div>
                            <br>
                            <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                              userForm.get(field.id) &&
                              (userForm.get(field.id).touched &&
                                userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                              {{demographiclabels.validation.DOB_validation}}
                            </div>
                          </span>
                        </ng-container>
                        <!-- Date fields-->
                        <ng-container *ngIf="field.controlType === 'date'">
                          <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy">
                              <mat-label>{{localeDtFormat}}</mat-label>
                              <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                              <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                              <mat-datepicker #dp></mat-datepicker>
                            </mat-form-field>
                          </span>
                        </ng-container>
                        <!-- Add Phone and Email in only one lang -->
                        <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                          <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy"
                              [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                              <!-- Again Label is required at each TextBox level too -->
                              <mat-label>
                                {{field.labelName[dataCaptureLanguage]}}
                              </mat-label>
                              <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)"
                                #input />
                            </mat-form-field>
                          </span>
                        </ng-container>
                        <!-- Error handling for various types -->
                        <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                          <mat-error class="primary-errors" *ngIf="
                        !readOnlyMode && primaryuserForm &&
                          userForm.get(field.id + '_' + dataCaptureLanguage) &&
                          userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                          userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                            {{ field.labelName[userPrefLanguage] }}
                            {{demographiclabels.validation.requiredMessage}}
                          </mat-error>
                          <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                          userForm.get(field.id + '_' + dataCaptureLanguage) &&
                          userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                          userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                          userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                            {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                            {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"]
                            }}<br>
                          </mat-error>
                        </span>
                        <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                        || field.controlType === 'dropdown' || field.controlType === 'button' 
                        || field.controlType === 'checkbox'
                        || (field.controlType === 'textbox' && field.type === 'string')">
                          <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                          !readOnlyMode && primaryuserForm &&
                          userForm.get(field.id) &&
                          userForm.get(field.id).hasError('required') &&
                          userForm.get(field.id).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                          userForm.get(field.id) &&
                          userForm.get(field.id).touched &&
                          userForm.get(field.id).dirty &&
                          userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage]
                              }}<br>
                              {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                        </span>
                      </span>
                    </div>
                  </div>
                </span>
              </div>
            </span>
          </mat-expansion-panel>

          <mat-expansion-panel *ngIf="isCopService()" [expanded]="expStep === 1" (opened)="setStep(1)" hideToggle>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <b>COP Categories and Services:</b>
              </mat-panel-title>

            </mat-expansion-panel-header>
            <span *ngFor="let alignmentGroup of alignmentGroups">
              <div class="columnContainer">
                <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                  <div class="fieldContainer"
                    *ngIf="field.isVisible == true && (field.renderID.startsWith('frm_3a_copcat') )">
                    
                    <div class="fieldContent" [ngStyle]="field.containerStyle">
                      <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                      <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                        <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                        <ng-container *ngIf="field.controlType === 'checkbox'">
                          <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                            <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                              (change)="onChangeHandler(field.id);">
                            </mat-checkbox>&nbsp;&nbsp;
                            <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                              <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                            </span>
                          </span>
                        </ng-container>
                        <ng-container *ngIf="field.controlType === 'button'">
                          <div class="buttonContainer">
                            <button 
                              class="toggleButton" 
                              [class.active]="userForm.get(field.id)?.value" 
                              (click)="toggleUserButton(field.id)">
                              {{ field.labelName[dataCaptureLanguage] }}
                            </button>
                          </div>
                        </ng-container>                        
                        <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                          <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy"
                              [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                              <mat-label>
                                {{field.description}}
                              </mat-label>
                              <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                (change)="onChangeHandler(field.id)"
                                (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                #input />
                              <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                            </mat-form-field>
                          </div>
                          <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy"
                              [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                              <!-- Again Label is required at each TextBox level too -->
                              <mat-label>
                                {{field.description}}
                              </mat-label>
                              <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                (change)="onChangeHandler(field.id)"
                                (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                #input />
                            </mat-form-field>
                          </div>
                        </ng-container>
                      </span>
                    </div>
                  </div>
                </span>
              </div>
            </span>
            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">Previous</button>
              <button mat-button color="primary" (click)="nextStep()">Next</button>
            </mat-action-row>
          </mat-expansion-panel>
          <mat-expansion-panel *ngIf="isCopService()" [expanded]="expStep === 2" (opened)="setStep(2)" hideToggle>
            <mat-expansion-panel-header>
              <mat-panel-title>
                <b>COP Categories and Services:</b>
              </mat-panel-title>

            </mat-expansion-panel-header>
            <span *ngFor="let alignmentGroup of alignmentGroups">
              <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                <div class="subsection-name" *ngIf="field.SectionName && field.isVisible == true && field.renderID.startsWith('frm_3a_copoptions')">
                  <b>{{field.SectionName}}:</b>
                </div>
              </span>
              <div class="rowContainer">
                <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                  <div class="fieldContainer"
                    *ngIf="field.isVisible == true && (field.renderID.startsWith('frm_3a_copoptions') )">
                    
                    <div>
                      <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                      <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                        <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                        <ng-container *ngIf="field.controlType === 'checkbox'">
                          <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                            <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                              (change)="onChangeHandler(field.id);">
                            </mat-checkbox>&nbsp;&nbsp;
                            <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                              <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                            </span>
                          </span>
                        </ng-container>
                        <ng-container *ngIf="field.controlType === 'button'">
                          <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                            <div class="buttonContainer">
                              <mat-button-toggle
                              class="toggleButton"
                              [class.active]="userForm.get(field.id)?.value"
                              [class.disabled]="userForm.get(field.id)?.disabled"
                              [disabled]="userForm.get(field.id)?.disabled"
                              (click)="toggleUserButton(field.id); onChangeHandler(field.id);">
                                {{ field.labelName[dataCaptureLanguage] }}
                            </mat-button-toggle>
                            </div>
                          </span>
                        </ng-container>                        
                        <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                          <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy"
                              [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                              <mat-label>
                                {{field.description}}
                              </mat-label>
                              <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                (change)="onChangeHandler(field.id)"
                                (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                #input />
                              <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                            </mat-form-field>
                          </div>
                          <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                            <mat-form-field appearance="legacy"
                              [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                              <!-- Again Label is required at each TextBox level too -->
                              <mat-label>
                                {{field.description}}
                              </mat-label>
                              <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                (change)="onChangeHandler(field.id)"
                                (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                #input />
                            </mat-form-field>
                          </div>
                        </ng-container>
                      </span>
                    </div>
                  </div>
                </span>
              </div>
            </span>
            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">Previous</button>
              <button mat-button color="primary" (click)="nextStep()">Next</button>
            </mat-action-row>
          </mat-expansion-panel>

          <mat-accordion  class="example-headers-align">
            <mat-expansion-panel *ngIf="!isCopService() && !isGetFirstId() && !isReplacement()"  [expanded]="expStep === 3" (opened)="setStep(3)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Personal Information:</b>
                </mat-panel-title>
                <mat-panel-description>
                  Please note: Maiden name and any previous names will not appear on the card.
                </mat-panel-description>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_a1')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }} <br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }} <br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            
            <mat-expansion-panel *ngIf="isCopService() || isGetFirstId() || isReplacement()" [expanded]="expStep === 4" (opened)="setStep(4)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Personal Information:</b>
                </mat-panel-title>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf=" isCopService() && field.isVisible == true && (field.renderID.startsWith('frm_3a_a9') || field.renderID.startsWith('frm_3a_a1_RewewNINI') || field.renderID.startsWith('frm_3a_a1I_countryCode') || field.renderID.startsWith('frm_3a_a1I_contact') ||  field.renderID.startsWith('frm_3a_a1I_homePhoneNo')  || field.renderID.startsWith('frm_3a_a1Iemail'))">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <ng-container *ngIf="field.controlType === 'ageDateCop'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAgeCop" #ageCop
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'ageDateCop'|| field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="fieldContainer" *ngIf=" isReplacement() && field.isVisible == true && (field.renderID.startsWith('frm_3a_a9') || field.renderID.startsWith('frm_3a_a1I_countryCode') || field.renderID.startsWith('frm_3a_a1I_contact') ||  field.renderID.startsWith('frm_3a_a1I_homePhoneNo')  || field.renderID.startsWith('frm_3a_a1Iemail'))">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <ng-container *ngIf="field.controlType === 'ageDateCop'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAgeCop" #ageCop
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'ageDateCop'|| field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="fieldContainer" *ngIf=" isGetFirstId() && field.isVisible == true && (field.renderID.startsWith('frm_3a_a9') || field.renderID.startsWith('frm_3a_a1_RewewNINI') || field.renderID.startsWith('frm_3a_gfid'))">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Add Age DateCop fields-->
                          <ng-container *ngIf="field.controlType === 'ageDateCop'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAgeCop" #ageCop
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'ageDateCop'|| field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>
          
            <mat-expansion-panel *ngIf="!isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 5" (opened)="setStep(5)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Place Of Residence:</b>
                </mat-panel-title>
               
              
              </mat-expansion-panel-header>
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_a2')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                            <!-- ERROR HANDLING FOR YEARS LIVED INVALID -->
                            <mat-error class="primary-errors" *ngIf="
                                                        !readOnlyMode && primaryuserForm &&
                                                        userForm.get(field.id ) &&
                                                        userForm.get(field.id ).hasError('yearsLivedInvalid')"
                              >
                            
                              {{ demographiclabels.validation.InvalidMessage }} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id)["errors"]["yearsLivedInvalid"]["message"] }}<br>
                              
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>

          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 6" (opened)="setStep(6)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Foundling Check:</b>                 
                
                </mat-panel-title>
                <mat-panel-description>
                  child/Adult with unknown birth, origin and parentage details
                </mat-panel-description>
              </mat-expansion-panel-header>
            
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
            
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID === 'frm_3afc_c7_Found_child'"> 
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <mat-checkbox [formControlName]="field.id" (change)="onChangeHandler(field.id)">
                          <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                            <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                          </span>
                        </mat-checkbox>
                        <span *ngIf="field.required" class="required-annotation"></span>
                        
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <span *ngIf="!readOnlyMode && primaryuserForm && userForm.get(field.id) && userForm.get(field.id).hasError('required') && userForm.get(field.id).touched">
                          <mat-error class="primary-errors">
                            {{ field.labelName[userPrefLanguage] }} {{demographiclabels.validation.requiredMessage}}
                          </mat-error>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
            
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>
          
            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 7" (opened)="setStep(7)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Place Of Birth:</b>
                </mat-panel-title>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_a3')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 8" (opened)="setStep(8)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title *ngIf="isByBirth()">
                  <b>Place of Origin and Passport Information:</b>
                </mat-panel-title>
                <mat-panel-title *ngIf="!isByBirth()">
                  <b>Place of Origin and Citizenship Information:</b>
                </mat-panel-title>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                  <div class="subsection-name" *ngIf="field.SectionName && field.isVisible == true && field.renderID.startsWith('frm_3a_a4')">
                    <b>{{field.SectionName}}:</b>
                  </div>
                </span>
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_a4')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate' ">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>
            
            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 9" (opened)="setStep(9)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Voters Information:</b>
                </mat-panel-title>
                <mat-panel-description>
                  Only filled if the applicant is above 16.
                </mat-panel-description>          
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_b5')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 10" (opened)="setStep(10)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Marital Status:</b>
                </mat-panel-title>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_b_6')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>



            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 11" (opened)="setStep(11)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Spouse Details:</b>
                </mat-panel-title>
                <mat-panel-description>
                  Note: Male applicants can add up to 4 spouses, while female applicants can add 1 spouse.
                </mat-panel-description>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                  <div class="subsection-name" *ngIf="field.SectionName && field.isVisible == true && field.renderID.startsWith('frm_3a_b6a')">
                    <b>{{field.SectionName}}:</b>
                  </div>
                </span>
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_b6a')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                              (change)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="!isRenewalService()  && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 12" (opened)="setStep(12)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Father's Details:</b>
                </mat-panel-title>
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_c7')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 13" (opened)="setStep(13)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Mother's Details</b>
                </mat-panel-title>
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_c8')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                        
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 14" (opened)="setStep(14)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Blood Relative's/Introducer Details:</b>
                </mat-panel-title>
                <mat-panel-description>
                  Only filled if you don't have either Mother's or Father's valid NIN
                </mat-panel-description>
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_c9')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 15" (opened)="setStep(15)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Particulars of Applicant’s Children :</b>
                </mat-panel-title>
                <mat-panel-description>
                  Maximum of 6 children can be added
                </mat-panel-description>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                  <div class="subsection-name" *ngIf="field.SectionName && field.isVisible == true && field.renderID.startsWith('frm_3a_e1')">
                    <b>{{field.SectionName}}:</b>
                  </div>
                </span>
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_e1')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                              (change)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>
            <mat-expansion-panel *ngIf="isCopService()" [expanded]="expStep === 16" (opened)="setStep(16)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Notification of Change:</b>
                </mat-panel-title>
                <mat-panel-description>
                
                </mat-panel-description>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="subsection-name" *ngIf="field.SectionName && field.isVisible == true && (field.renderID.startsWith('frm_3a_a1_C_') ||field.renderID.startsWith('frm_3a_a2') || field.renderID.startsWith('frm_3a_a4_') || field.renderID.startsWith('frm_3a_c7_C') || field.renderID.startsWith('frm_3a_c8_C_') || field.renderID.startsWith('frm_3a_a3') || field.renderID.startsWith('frm_3a_b5') || field.renderID.startsWith('frm_isErrorOccurredbyNIRA') || field.renderID.startsWith('frm_3a_b6a'))">
                      <b *ngIf="field.SectionName !== 'name' && !field.SectionName.startsWith('Spouse')">{{ field.SectionName }}:</b>
                      <b *ngIf="field.SectionName.startsWith('Spouse')">Add {{ field.SectionName }}:</b>
                      <b *ngIf="field.SectionName === 'name' && this.copAddName">Adding a Name:</b>
                      <b *ngIf="field.SectionName === 'name' && this.copChangeNameOrder">Change of Order of Names:</b>
                      <b *ngIf="field.SectionName === 'name' && this.copCompleChange">Complete Change of Name:</b>
                    </div>
                  </span>
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && (field.renderID.startsWith('frm_3a_a1_C_') ||field.renderID.startsWith('frm_3a_a2') || field.renderID.startsWith('frm_3a_a4_') || field.renderID.startsWith('frm_3a_c7_C') || field.renderID.startsWith('frm_3a_c8_C_') || field.renderID.startsWith('frm_3a_a3') || field.renderID.startsWith('frm_3a_b5') || field.renderID.startsWith('frm_3a_b6a'))">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.description}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                              (change)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                      
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <!-- ERROR HANDLING FOR YEARS LIVED INVALID -->
                            <mat-error class="primary-errors" *ngIf="
                                                        !readOnlyMode && primaryuserForm &&
                                                        userForm.get(field.id ) &&
                                                        userForm.get(field.id ).hasError('yearsLivedInvalid')"
                              >
                            
                              {{ demographiclabels.validation.InvalidMessage }} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id)["errors"]["yearsLivedInvalid"]["message"] }}<br>
                              
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
                <div class="columnContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer"
                      *ngIf="field.isVisible == true && (field.renderID.startsWith('frm_isErrorOccurredbyNIRA') )">
                      
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                              <!-- Left Side: Description -->
                              <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]" style="flex: 1; text-align: left;">
                                {{ field.labelName[userPrefLanguage] }}
                              </span>
                          
                              <!-- Right Side: Dropdown Selection -->
                              <mat-form-field appearance="legacy" 
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr' ? {'text-align': 'left'} : {'text-align': 'right'}"
                                style="flex: 2; margin-left: 10px;">
                                <!-- Placeholder for Dropdown -->
                                <mat-label>
                                  {{ field.description }}
                                </mat-label>
                                
                                <mat-select formControlName="{{ field.id }}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id) : ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <!-- Search Option -->
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <!-- Loading Spinner -->
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%;"></mat-spinner>
                                  </mat-option>
                                  <!-- Dropdown Options -->
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{ getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage) }}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                            </div>
                          
                            <!-- Additional Display for Selected Option in Other Languages -->
                            <p></p>
                            <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                              <div class="selectedOption">
                                <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                  <span *ngIf="option.languageCode !== dataCaptureLanguage 
                                    && userForm.get(field.id).value != null 
                                    && option.valueCode == userForm.get(field.id).value 
                                    && dataCaptureLanguages.includes(option.languageCode)">
                                    {{ option.valueName }}
                                  </span>
                                </span>
                              </div>
                            </span>
                          </ng-container>
                          
                          
                          
                          
                          <ng-container *ngIf="field.controlType === 'button'">
                            <div class="buttonContainer">
                              <button 
                                class="toggleButton" 
                                [class.active]="userForm.get(field.id)?.value" 
                                (click)="toggleUserButton(field.id)">
                                {{ field.labelName[dataCaptureLanguage] }}
                              </button>
                            </div>
                          </ng-container>                        
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>
            <mat-expansion-panel *ngIf="isReplacement()" [expanded]="expStep === 17" (opened)="setStep(17)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>National ID Number:</b>
                </mat-panel-title>
                <mat-panel-description>
                
                </mat-panel-description>
                
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="columnContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer"
                      *ngIf="field.isVisible == true && (field.renderID.startsWith('frm_idNumberKnown') )">
                      
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                              <!-- Left Side: Description -->
                              <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]" style="flex: 1; text-align: left;">
                                {{ field.labelName[userPrefLanguage] }}
                              </span>
                              <span *ngIf="field.required" class="required-annotation">*</span>
                              <!-- testing asterik -->
                          
                              <!-- Right Side: Dropdown Selection -->
                              <mat-form-field appearance="legacy" 
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr' ? {'text-align': 'left'} : {'text-align': 'right'}"
                                style="flex: 2; margin-left: 10px;">
                                <!-- Placeholder for Dropdown -->
                                <mat-label>
                                  {{ field.description }}
                                </mat-label>
                                
                                <mat-select formControlName="{{ field.id }}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id) : ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <!-- Search Option -->
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <!-- Loading Spinner -->
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%;"></mat-spinner>
                                  </mat-option>
                                  <!-- Dropdown Options -->
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{ getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage) }}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                            </div>
                          
                            <!-- Additional Display for Selected Option in Other Languages -->
                            <p></p>
                            <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                              <div class="selectedOption">
                                <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                  <span *ngIf="option.languageCode !== dataCaptureLanguage 
                                    && userForm.get(field.id).value != null 
                                    && option.valueCode == userForm.get(field.id).value 
                                    && dataCaptureLanguages.includes(option.languageCode)">
                                    {{ option.valueName }}
                                  </span>
                                </span>
                              </div>
                            </span>
                          </ng-container>
                          
                          
                          
                          
                          <ng-container *ngIf="field.controlType === 'button'">
                            <div class="buttonContainer">
                              <button 
                                class="toggleButton" 
                                [class.active]="userForm.get(field.id)?.value" 
                                (click)="toggleUserButton(field.id)">
                                {{ field.labelName[dataCaptureLanguage] }}
                              </button>
                            </div>
                          </ng-container>                        
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && (field.renderID.startsWith('frm_3a_a1_RewewNINI'))">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.description}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                              (change)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                      
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>
            <mat-expansion-panel *ngIf="!isRenewalService() && !isGetFirstId() && !isReplacement()" [expanded]="expStep === 18" (opened)="setStep(18)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Declarant's Details:</b>
                </mat-panel-title>
                <mat-panel-description *ngIf="!isRenewalService() && !isCopService() && !isGetFirstId() && !isReplacement()">
                  Only required if the applicant age is below 18 years
                </mat-panel-description>
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID.startsWith('frm_3a_d1')">
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                  
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="isCopService()" [expanded]="expStep === 19" (opened)="setStep(19)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Require a new Card:</b> 
                </mat-panel-title>
                <mat-panel-description>
                  Card renewal is mandatory for changes that affect the details displayed on the physical ID card
                </mat-panel-description>
              </mat-expansion-panel-header>
            
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
            
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID === 'frm_700a_a3_isCardRequired'"> 
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                        <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
            
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>
            <mat-expansion-panel *ngIf="isCopService() && isRenewalService()" [expanded]="expStep === 20" (opened)="setStep(20)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Error Occurred by NIRA:</b> 
                </mat-panel-title>
                <mat-panel-description>
                </mat-panel-description>
              </mat-expansion-panel-header>
            
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
            
                    <div class="fieldContainer" *ngIf="field.isVisible == true && field.renderID === 'frm_700a_a8_isErrorOccurredbyNIRA'"> 
                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                        <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                                {{ field.labelName[userPrefLanguage] }} {{ demographiclabels.validation.InvalidMessage}}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
            
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>

            <mat-expansion-panel *ngIf="isGetFirstId()" [expanded]="expStep === 21" (opened)="setStep(21)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
               <b>Information to be Updated:</b>
                </mat-panel-title>
              </mat-expansion-panel-header>
          
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">

                  <div class="subsection-name" *ngIf="field.SectionName && field.isVisible == true && (field.renderID.startsWith('frm_3a_a1_o') || field.renderID.startsWith('frm_3a_a1I') || field.renderID.startsWith('frm_3a_a2') || field.renderID.startsWith('frm_3a_b5'))">

                    <b>{{field.SectionName}}:</b>
                  </div>
                </span>
                <div class="rowContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">

                    <div class="fieldContainer" *ngIf="field.isVisible == true && (field.renderID.startsWith('frm_3a_a1_o') || field.renderID.startsWith('frm_3a_a1I') || field.renderID.startsWith('frm_3a_a2') || field.renderID.startsWith('frm_3a_b5'))">

                      <div class="fieldHeader" [ngStyle]="field.headerStyle">
                        <!-- Create container header with label in user's login lang -->
                        <mat-label>{{field.labelName[userPrefLanguage]}} : </mat-label>
                        <span *ngIf="field.required" class="required-annotation">*</span>
                      </div>
                      <div class="fieldContent" [ngStyle]="field.containerStyle">
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add TextBox for each dataCaptureLanguage -->
                          <ng-container *ngIf="field.controlType === 'textbox' && field.type !== 'string'">
                            <div *ngIf="!readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                                <i *ngIf="dataCaptureLangsDir[i] === 'ltr'"
                                  style="float: right; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                                <i *ngIf="dataCaptureLangsDir[i] === 'rtl'"
                                  style="float: left; color: grey; cursor: pointer;" matSuffix class="material-icons"
                                  (click)="openKeyboard(field.id, dataCaptureLanguage)">keyboard</i>
                              </mat-form-field>
                            </div>
                            <div *ngIf="readOnlyMode" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <input matInput [formControlName]="field.id + '_' + dataCaptureLanguage"
                                  (change)="onChangeHandler(field.id)"
                                  (focusout)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)"
                                  (input)="transliterateFieldValue(field.id, dataCaptureLanguage, $event)" #keyboardRef
                                  #input />
                              </mat-form-field>
                            </div>
                          </ng-container>
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Button Options in  only one language on mouse over other lang are shown -->
                          <ng-container *ngIf="field.controlType === 'button'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-button-toggle-group class="btn_grp" [formControlName]="field.id"
                                (click)="onChangeHandler(field.id);">
                                <ng-container *ngFor="let button of selectOptionsDataArray[field.id]">
                                  <span *ngIf="button.languageCode === dataCaptureLanguage">
                                    <mat-button-toggle class="btn_grp mat-button-toggle" value="{{button.valueCode}}"
                                      title="{{getTitleForOptionInOtherLangs(field.id, button.valueCode, dataCaptureLanguage)}}">
                                      {{button.valueName}}
                                    </mat-button-toggle>
                                  </span>
                                </ng-container>
                              </mat-button-toggle-group>
                              <br>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1"
                                [dir]="dataCaptureLangsDir[i]">
                                <span *ngFor="let option of selectOptionsDataArray[field.id]">
                                  <span
                                    *ngIf="option.languageCode !== dataCaptureLanguage && option.valueCode === userForm.get(field.id).value && dataCaptureLanguages.includes(option.languageCode)">
                                    <span class="selectedOption">{{option.valueName}}</span>
                                  </span>
                                </span>
                              </span>
                            </span>
                          </ng-container>
                          <!-- Add Dropdown Options in  only one language on mouse over other lang are shown-->
                          <ng-container *ngIf="field.controlType === 'dropdown'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <mat-label>
                                  {{field.description}}
                                </mat-label>
                                <mat-select formControlName="{{field.id}}"
                                  (focus)="!readOnlyMode ? dropdownApiCall(field.id): ''"
                                  (blur)="onChangeHandler(field.id);" #singleSelect>
                                  <mat-option>
                                    <ngx-mat-select-search formControlName="{{field.id + '_search'}}"
                                      placeholderLabel="{{ 'demographic.lookup_search_message' | translate }}"
                                      noEntriesFoundLabel="{{ 'demographic.lookup_no_results_found' | translate }}">
                                    </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngIf="selectOptionsDataArray[field.id].length == 0">
                                    <mat-spinner [diameter]="20" style="margin-left: 43%"></mat-spinner>
                                  </mat-option>
                                  <ng-container *ngIf="selectOptionsDataArray[field.id].length > 0">
                                    <ng-container *ngFor="let dropdown of filteredSelectOptions[field.id] | async">
                                      <mat-option *ngIf="dropdown.languageCode === dataCaptureLanguage"
                                        [value]="dropdown.valueCode"
                                        title="{{getTitleForOptionInOtherLangs(field.id, dropdown.valueCode, dataCaptureLanguage)}}">
                                        {{ dropdown.valueName }}
                                      </mat-option>
                                    </ng-container>
                                  </ng-container>
                                </mat-select>
                              </mat-form-field>
                              <p></p>
                              <span *ngIf="field.type !== 'string' && dataCaptureLanguages.length > 1">
                                <div class="selectedOption">
                                  <span *ngFor="let option of selectOptionsDataArray[field.id];">
                                    <span *ngIf="option.languageCode !== dataCaptureLanguage
                                      && userForm.get(field.id).value != null 
                                      && option.valueCode == userForm.get(field.id).value 
                                      && dataCaptureLanguages.includes(option.languageCode)">{{option.valueName}}
                                    </span>
                                  </span>
                                </div>
                              </span>                              
                            </span>
                          </ng-container>
                          <!-- Add Age Date fields-->
                          <ng-container *ngIf="field.controlType === 'ageDate'">
                            <span *ngIf="i == 0">
                              <div class="user__age-or-date" [dir]="dataCaptureLangsDir[i]">
                                <div class="user__date">                                
                                  <mat-form-field appearance="legacy">
                                    <mat-label>{{localeDtFormat}}</mat-label>
                                    <input matInput [formControlName]="field.id + '_dateCtrl'"
                                      placeholder="{{localeDtFormat}}"
                                      (dateChange)="onDOBChange(field.id);onChangeHandler(field.id);"
                                      [matDatepicker]="dp" />
                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                    <mat-datepicker #dp></mat-datepicker>
                                  </mat-form-field>
                                </div>
                                <div class="user__pref">
                                  {{ "demographic.text_or" | translate }}
                                </div>
                                <div class="user__age">
                                  <mat-form-field appearance="legacy">
                                    <input type="number" class="form-control" matInput [value]="currentAge" #age
                                      [disabled]="readOnlyMode" placeholder="{{ 'demographic.label_age' | translate }}"
                                      (change)="onAgeChange(field.id);onChangeHandler(field.id);">
                                  </mat-form-field>
                                  <div class="user__age--years">
                                    {{ "demographic.text_years" | translate }}
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="mat-error ng-star-inserted user__dob__error" *ngIf="!readOnlyMode && primaryuserForm &&    
                                  userForm.get(field.id) &&
                                  (userForm.get(field.id).touched &&
                                    userForm.get(field.id).hasError('incorrect'))" [dir]="userPrefLanguageDir">
                                {{demographiclabels.validation.DOB_validation}}
                              </div>
                            </span>
                          </ng-container>
                          <!-- Date fields-->
                          <ng-container *ngIf="field.controlType === 'date'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy">
                                <mat-label>{{localeDtFormat}}</mat-label>
                                <input matInput [formControlName]="field.id" placeholder='{{localeDtFormat}}'
                                  (dateChange)="onChangeHandler(field.id);" [matDatepicker]="dp" />
                                <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                <mat-datepicker #dp></mat-datepicker>
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Add Phone and Email in only one lang -->
                          <ng-container *ngIf="(field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-form-field appearance="legacy"
                                [ngStyle]="dataCaptureLangsDir[i] == 'ltr'? {'text-align': 'left'} : {'text-align': 'right'}">
                                <!-- Again Label is required at each TextBox level too -->
                                <mat-label>
                                  {{field.labelName[dataCaptureLanguage]}}
                                </mat-label>
                                <input matInput [formControlName]="field.id" (change)="onChangeHandler(field.id)" #input />
                              </mat-form-field>
                            </span>
                          </ng-container>
                          <!-- Error handling for various types -->
                          <span *ngIf="field.controlType === 'textbox'" [dir]="userPrefLanguageDir">
                            <mat-error class="primary-errors" *ngIf="
                            !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('required') &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched">
                              {{ field.labelName[userPrefLanguage] }}
                              {{demographiclabels.validation.requiredMessage}}
                            </mat-error>
                            <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id + '_' + dataCaptureLanguage) &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).touched &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).dirty &&
                              userForm.get(field.id + '_' + dataCaptureLanguage).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                              {{ userForm.get(field.id + '_' + dataCaptureLanguage)["errors"]["customPattern"]["msg"] }}<br>
                            </mat-error>
                          </span>
                          <span *ngIf="field.controlType === 'ageDate' || field.controlType === 'date' 
                            || field.controlType === 'dropdown' || field.controlType === 'button' 
                            || field.controlType === 'checkbox'
                            || (field.controlType === 'textbox' && field.type === 'string')">
                            <span *ngIf="i == 0" [dir]="userPrefLanguageDir">
                              <mat-error class="primary-errors" *ngIf="
                              !readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).hasError('required') &&
                              userForm.get(field.id).touched">
                                {{ field.labelName[userPrefLanguage] }}
                                {{demographiclabels.validation.requiredMessage}}
                              </mat-error>
                              <mat-error class="primary-errors" *ngIf="!readOnlyMode && primaryuserForm &&
                              userForm.get(field.id) &&
                              userForm.get(field.id).touched &&
                              userForm.get(field.id).dirty &&
                              userForm.get(field.id).hasError('customPattern')">
                              {{ demographiclabels.validation.InvalidMessage}} {{ field.labelName[userPrefLanguage] }}<br>
                                {{ userForm.get(field.id)["errors"]["customPattern"]["msg"] }}<br>
                              </mat-error>
                            </span>
                          </span>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
          
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
                <button mat-button color="primary" (click)="nextStep()">Next</button>
              </mat-action-row>
            </mat-expansion-panel>
            

            <mat-expansion-panel [expanded]="expStep === 22" (opened)="setStep(22)" hideToggle>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <b>Declaration: *</b>
                </mat-panel-title>
                <mat-panel-description>
                </mat-panel-description>
              </mat-expansion-panel-header>
            
              <span *ngFor="let alignmentGroup of alignmentGroups">
                <div class="columnContainer">
                  <span *ngFor="let field of uiFieldsForAlignmentGroups[alignmentGroup]; index as uiFieldIndex">
                    <div class="fieldContainer"
                      *ngIf="field.isVisible == true && (field.renderID.startsWith('frm_700a_a3_declarationCheckBox') )">
                      
                      <div >
                        <!-- Create form fields to capture data in all chosen dataCaptureLanguages -->
                        <span *ngFor="let dataCaptureLanguage of dataCaptureLanguages;index as i">
                          <!-- Add CheckBox only once, but show Labels in all dataCaptureLanguages -->
                          <ng-container *ngIf="field.controlType === 'checkbox'">
                            <span *ngIf="i == 0" [dir]="dataCaptureLangsDir[i]">
                              <mat-checkbox class="form_checkBox" [formControlName]="field.id"
                                (change)="onChangeHandler(field.id);">
                              </mat-checkbox>&nbsp;&nbsp;
                              <span *ngFor="let lang of dataCaptureLanguages;index as langIndex">
                                <span *ngIf="langIndex !== 0"> / </span>{{field.labelName[lang]}}
                              </span>
                            </span>
                          </ng-container>
                        </span>
                      </div>
                    </div>
                  </span>
                </div>
              </span>
            
              <mat-action-row>
                <button mat-button color="warn" (click)="prevStep()">Previous</button>
              </mat-action-row>
            </mat-expansion-panel>
            

          </mat-accordion>

        </form>
      </div>
    </div>
  </div>
  <div class="user__buttons" *ngIf="primaryuserForm">
    <div class="displayError" *ngIf="!userForm.valid && isSubmitted">
      {{getValidationErrorMessages()}}
</div>
    <button *ngIf="!showPreviewButton" class="user__btn" type="button" [disabled]="!dataUploadComplete"
      (click)="onSubmit()">
      {{demographiclabels.action_continue}}
    </button>
    <button *ngIf="showPreviewButton" class="user__btn" type="button" [disabled]="!dataUploadComplete"
      (click)="onSubmit()">
      {{demographiclabels.action_preview}}
    </button>
    
  </div>
</div>
